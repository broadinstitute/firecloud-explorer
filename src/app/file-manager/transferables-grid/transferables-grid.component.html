<h1>Progress Status</h1>

<div class="flex-container space-between">
  <div class="status-box-left">
    <div class="flex-container space-between">
      <h4 class="subtitle">Downloaded: {{filesDatabase.downloadingCount + ' of ' + filesDatabase.toDownloadCount}} file(s)</h4>
      <h4 class="subtitle">{{generalProgress}}%</h4>
    </div>

    <p-progressBar mode="determinate" class="progress-bar" [value]="generalProgress" [showValue]="false"></p-progressBar>

    <div class="flex-container end actions">
      <button mat-raised-button (click)="pauseSelected()" class="button-secondary">
        <i class="material-icons">highlight_off</i>Cancel Download</button>
      <!-- <button mat-raised-button (click)="resumeSelected()" class="button-primary">
        <i class="material-icons">pause_circle_outline</i>Pause all</button> -->
    </div>
  </div>

  <div class="status-box-right">
    <div class="flex-container space-between">
      <h4 class="subtitle">Uploaded: {{filesDatabase.uploadingCount + ' of ' + filesDatabase.toUploadCount}} file(s)</h4>
      <h4 class="subtitle">{{generalUploadProgress}}%</h4>
    </div>

    <p-progressBar mode="determinate" class="progress-bar" [value]="generalUploadProgress" [showValue]="false"></p-progressBar>

    <div class="flex-container end actions">
      <button mat-raised-button (click)="pauseSelected()" class="button-secondary">
        <i class="material-icons">highlight_off</i>Cancel Upload</button>
      <!-- <button mat-raised-button (click)="resumeSelected()" class="button-primary">
        <i class="material-icons">pause_circle_outline</i>Pause all</button> -->
    </div>
  </div>
</div>

<mat-expansion-panel #expa class="expand-panel">
  <mat-expansion-panel-header>
    <mat-panel-title>{{ expa.expanded ? 'Hide detailed transfer list' : 'Show detailed download list'}}</mat-panel-title>
  </mat-expansion-panel-header>

  <div class="table-container flex-container column">
    <mat-table #table [dataSource]="dataSource" matSort class="table-common">
      <ng-container matColumnDef="id">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Id </mat-header-cell>
        <mat-cell *matCellDef="let row"> {{row.id}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef mat-sort-header style="flex: 0 0 40%;"> Name </mat-header-cell>
        <mat-cell *matCellDef="let row" style="flex: 0 0 40%;"> {{row.name}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="size">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Size </mat-header-cell>
        <mat-cell *matCellDef="let row"> {{row.size | filesize}} </mat-cell>
      </ng-container>

      <ng-container matColumnDef="status">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Status </mat-header-cell>
        <mat-cell *matCellDef="let row">
          <mat-icon class="transfer-icon" *ngIf="row.type == 'Download'">file_download</mat-icon>
          <mat-icon class="transfer-icon" *ngIf="row.type == 'Upload'">file_upload</mat-icon>
          {{row.status}}
          <div *ngIf="row.status == 'Downloading' || row.status == 'Uploading'" class="progress-dots transfer-status">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </div>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="progress">
        <mat-header-cell *matHeaderCellDef mat-sort-header> Progress </mat-header-cell>
        <mat-cell *matCellDef="let row">
          <p-progressBar mode="determinate" class="progress-bar-small" [value]=row.progress [showValue]="false"></p-progressBar>
        </mat-cell>
      </ng-container>

      <ng-container matColumnDef="actions">
        <mat-header-cell *matHeaderCellDef mat-sort-header style="flex: 0 0 85px; text-align: center;"> Actions </mat-header-cell>
        <mat-cell *matCellDef="let row" style="flex: 0 0 85px;">
          <button mat-icon-button class="button-icon" disabled>
            <mat-icon aria-label="Cancel file download">highlight_off</mat-icon>
          </button>
          <button mat-icon-button class="button-icon" disabled>
            <mat-icon aria-label="Pause file download">pause_circle_outline</mat-icon>
          </button>
        </mat-cell>
      </ng-container>

      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </mat-table>

    <mat-paginator #paginator [length]="filesDatabase.data.length" [pageIndex]="0" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 50, 100]"
      class="paginator"></mat-paginator>
  </div>
</mat-expansion-panel>