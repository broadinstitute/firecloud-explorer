<ngx-spinner #spin bdOpacity="0.6" bdColor="#fff" size="medium" color="#1e88e5" type="ball-circus" style="z-index:10000"></ngx-spinner>

<h1>Progress Status</h1>
<div class="flex-container space-between">
  <div class="status-box">
    <h4 class="subtitle medium">Downloaded:</h4>
    <div class="flex-container space-between">
      <p class="aclaration">{{ downCompleted + ' of ' + downTotal }} file(s)</p>
      <h4 class="subtitle light">{{ downProgress | number:'1.0-0' }}%</h4>
    </div>

    <p-progressBar mode="determinate" class="progress-bar" [ngClass]="{'success': downProgress === 100, 'failure': downloadCanceled}"
      [value]="downProgress" [showValue]="false"></p-progressBar>

    <div class="flex-container end actions">
      <button mat-raised-button (click)="cancelDownloads()" class="button-secondary" [disabled]="!downloadInProgress">
        <i class="material-icons">highlight_off</i>Cancel Download
      </button>
      <!-- <button mat-raised-button (click)="resumeSelected()" class="button-primary">
        <i class="material-icons">pause_circle_outline</i>Pause all</button> -->
    </div>
  </div>

  <div class="status-box">
    <h4 class="subtitle medium">Uploaded:</h4>
    <div class="flex-container space-between">
      <p class="aclaration">{{ upCompleted + ' of ' + upTotal }} file(s)</p>
      <h4 class="subtitle light">{{ upProgress | number:'1.0-0' }}%</h4>
    </div>

    <p-progressBar mode="determinate" class="progress-bar" [ngClass]="{'success': upProgress === 100, 'failure': !uploadPending && upTotal !== 0}"
      [value]="upProgress" [showValue]="false"></p-progressBar>

    <div class="flex-container end actions">
      <button mat-raised-button (click)="cancelUploads()" class="button-secondary" [disabled]="!uploadPending || !uploadInProgress">
        <i class="material-icons">highlight_off</i>Cancel Upload
      </button>
    </div>
  </div>
  <div class="status-box">
    <h4 class="subtitle medium">Exported to Google Cloud:</h4>
    <div class="flex-container space-between">

      <p class="aclaration">{{ filesDatabase.exportedToGCSCount() + ' of ' + filesDatabase.toExportGCSCount() }} file(s)</p>
      <h4 class="subtitle light">{{ gcsProgress | number:'1.0-0' }}%</h4>
    </div>

    <p-progressBar #pbg mode="determinate" class="progress-bar" [ngClass]="{'success': gcsProgress === 100, 'failure': ( !exportToGCSpending && gcsTotal !== 0)}"
      [value]="gcsProgress" [showValue]="false"></p-progressBar>

    <div class="flex-container end actions">
      <button mat-raised-button (click)="cancelExportsToGCP()" class="button-secondary" [disabled]="!exportToGCSpending">
        <i class="material-icons">highlight_off</i>Cancel Export
      </button>
    </div>
  </div>

  <div class="status-box">
    <h4 class="subtitle medium">Exported to Amazon:</h4>
    <div class="flex-container space-between">
      <p class="aclaration">{{ s3Completed + ' of ' + s3Total }} file(s)</p>
      <h4 class="subtitle light">{{ s3Progress | number:'1.0-0' }}%</h4>
    </div>

    <p-progressBar mode="determinate" class="progress-bar" [ngClass]="{'success': s3Progress === 100, 'failure': ( !exportToS3pending && s3Total !== 0 && !s3InProgress)}"
      [value]="s3Progress" [showValue]="false"></p-progressBar>

    <div class="flex-container end actions">
      <button mat-raised-button (click)="cancelExportsToS3()" class="button-secondary" [disabled]="!exportToS3pending">
        <i class="material-icons">highlight_off</i>Cancel Export
      </button>
    </div>
  </div>
</div>

<div class="position-relative">
  <mat-form-field class="search-transfers-container">
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Search...">
  </mat-form-field>
</div>

<mat-tab-group class="tab-group" [selectedIndex]="selectedIndex">

  <mat-tab label="Downloads">
    <app-progress-tab source="Down" [filter]="tabFilter">
    </app-progress-tab>
  </mat-tab>

  <mat-tab label="Uploads">
    <app-progress-tab source="Up" [filter]="tabFilter">
    </app-progress-tab>
  </mat-tab>

  <mat-tab  label="Exports to Google Cloud">
    <app-progress-tab source="GCS" [filter]="tabFilter">
    </app-progress-tab>
  </mat-tab>

  <mat-tab label="Exports to Amazon S3">
    <app-progress-tab source="S3" [filter]="tabFilter">
    </app-progress-tab>
  </mat-tab>

</mat-tab-group>

